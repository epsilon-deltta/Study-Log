<!DOCTYPE html><html lang="en" > <!-- The Head v2.0 https://github.com/cotes2020/jekyll-theme-chirpy © 2017-2019 Cotes Chung MIT License --><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>언어모델, BERT 알아보기 | Jongsky Study Log</title><meta name="generator" content="Jekyll v4.2.0" /><meta property="og:title" content="언어모델, BERT 알아보기" /><meta name="author" content="JONGSKY" /><meta property="og:locale" content="en_US" /><meta name="description" content="한국어 기사 요약 프로젝트를 시작하며 프로젝트에 도입해야할 여러 논문들과 연구들을 찾았습니다. 그중에서도 언어모델로 유명한 BERT 모델에 대해 정리하면 좋을 것 같다고 생각하여 작성하게 되었습니다." /><meta property="og:description" content="한국어 기사 요약 프로젝트를 시작하며 프로젝트에 도입해야할 여러 논문들과 연구들을 찾았습니다. 그중에서도 언어모델로 유명한 BERT 모델에 대해 정리하면 좋을 것 같다고 생각하여 작성하게 되었습니다." /><link rel="canonical" href="https://jongsky.github.io/Study-Log/posts/%EC%96%B8%EC%96%B4%EB%AA%A8%EB%8D%B8,-BERT-%EC%95%8C%EC%95%84%EB%B3%B4%EA%B8%B0/" /><meta property="og:url" content="https://jongsky.github.io/Study-Log/posts/%EC%96%B8%EC%96%B4%EB%AA%A8%EB%8D%B8,-BERT-%EC%95%8C%EC%95%84%EB%B3%B4%EA%B8%B0/" /><meta property="og:site_name" content="Jongsky Study Log" /><meta property="og:type" content="article" /><meta property="article:published_time" content="2020-09-26T02:25:00+09:00" /><meta name="google-site-verification" content="google_meta_tag_verification" /> <script type="application/ld+json"> {"description":"한국어 기사 요약 프로젝트를 시작하며 프로젝트에 도입해야할 여러 논문들과 연구들을 찾았습니다. 그중에서도 언어모델로 유명한 BERT 모델에 대해 정리하면 좋을 것 같다고 생각하여 작성하게 되었습니다.","@type":"BlogPosting","headline":"언어모델, BERT 알아보기","dateModified":"2020-09-26T02:25:00+09:00","datePublished":"2020-09-26T02:25:00+09:00","url":"https://jongsky.github.io/Study-Log/posts/%EC%96%B8%EC%96%B4%EB%AA%A8%EB%8D%B8,-BERT-%EC%95%8C%EC%95%84%EB%B3%B4%EA%B8%B0/","mainEntityOfPage":{"@type":"WebPage","@id":"https://jongsky.github.io/Study-Log/posts/%EC%96%B8%EC%96%B4%EB%AA%A8%EB%8D%B8,-BERT-%EC%95%8C%EC%95%84%EB%B3%B4%EA%B8%B0/"},"author":{"@type":"Person","name":"JONGSKY"},"@context":"https://schema.org"}</script> <!-- The Favicons for Web, Android, Microsoft, and iOS (iPhone and iPad) Apps Generated by: https://www.favicon-generator.org/ v2.0 https://github.com/cotes2020/jekyll-theme-chirpy © 2019 Cotes Chung Published under the MIT license --><link rel="shortcut icon" href="/Study-Log/assets/img/favicons/favicon.ico" type="image/x-icon"><link rel="icon" href="/Study-Log/assets/img/favicons/favicon.ico" type="image/x-icon"><link rel="apple-touch-icon" href="/Study-Log/assets/img/favicons/apple-icon.png"><link rel="apple-touch-icon" href="/Study-Log/assets/img/favicons/apple-icon-precomposed.png"><link rel="apple-touch-icon" sizes="57x57" href="/Study-Log/assets/img/favicons/apple-icon-57x57.png"><link rel="apple-touch-icon" sizes="60x60" href="/Study-Log/assets/img/favicons/apple-icon-60x60.png"><link rel="apple-touch-icon" sizes="72x72" href="/Study-Log/assets/img/favicons/apple-icon-72x72.png"><link rel="apple-touch-icon" sizes="76x76" href="/Study-Log/assets/img/favicons/apple-icon-76x76.png"><link rel="apple-touch-icon" sizes="114x114" href="/Study-Log/assets/img/favicons/apple-icon-114x114.png"><link rel="apple-touch-icon" sizes="120x120" href="/Study-Log/assets/img/favicons/apple-icon-120x120.png"><link rel="apple-touch-icon" sizes="144x144" href="/Study-Log/assets/img/favicons/apple-icon-144x144.png"><link rel="apple-touch-icon" sizes="152x152" href="/Study-Log/assets/img/favicons/apple-icon-152x152.png"><link rel="apple-touch-icon" sizes="180x180" href="/Study-Log/assets/img/favicons/apple-icon-180x180.png"><link rel="icon" type="image/png" sizes="192x192" href="/Study-Log/assets/img/favicons/android-icon-192x192.png"><link rel="icon" type="image/png" sizes="32x32" href="/Study-Log/assets/img/favicons/favicon-32x32.png"><link rel="icon" type="image/png" sizes="96x96" href="/Study-Log/assets/img/favicons/favicon-96x96.png"><link rel="icon" type="image/png" sizes="16x16" href="/Study-Log/assets/img/favicons/favicon-16x16.png"><link rel="manifest" href="/Study-Log/assets/img/favicons/manifest.json"><meta name='msapplication-config' content='/Study-Log/assets/img/favicons/browserconfig.xml'><meta name="msapplication-TileColor" content="#ffffff"><meta name="msapplication-TileImage" content="/Study-Log/assets/img/favicons/ms-icon-144x144.png"><meta name="theme-color" content="#ffffff"><link rel="preconnect" href="https://fonts.gstatic.com" crossorigin="anonymous"><link rel="dns-prefetch" href="https://fonts.gstatic.com"><link rel="preconnect" href="https://www.google-analytics.com" crossorigin="use-credentials"><link rel="dns-prefetch" href="https://www.google-analytics.com"><link rel="preconnect" href="https://www.googletagmanager.com" crossorigin="anonymous"><link rel="dns-prefetch" href="https://www.googletagmanager.com"><link rel="preconnect" href="cdn.jsdelivr.net"><link rel="dns-prefetch" href="cdn.jsdelivr.net"><link rel="preload" as="style" href="https://cdn.jsdelivr.net/npm/bootstrap@4.0.0/dist/css/bootstrap.min.css" integrity="sha256-LA89z+k9fjgMKQ/kq4OO2Mrf8VltYml/VES+Rg0fh20=" crossorigin><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4.0.0/dist/css/bootstrap.min.css" integrity="sha256-LA89z+k9fjgMKQ/kq4OO2Mrf8VltYml/VES+Rg0fh20=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@5.11.2/css/all.min.css" integrity="sha256-+N4/V/SbAFiW1MPBCXnfnP9QSN3+Keu+NlB+0ev/YKQ=" crossorigin="anonymous"> <!-- CSS selector for site. Chirpy v2.3 https://github.com/cotes2020/jekyll-theme-chirpy © 2020 Cotes Chung MIT Licensed --><link rel="preload" as="style" href="/Study-Log/assets/css/post.css"><link rel="stylesheet" href="/Study-Log/assets/css/post.css"><link rel="preload" as="script" href="https://cdn.jsdelivr.net/npm/jquery@3.4.1" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"> <script src="https://cdn.jsdelivr.net/npm/jquery@3.4.1" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script> <script src="https://cdn.jsdelivr.net/combine/npm/popper.js@1.15.0,npm/bootstrap@4.0.0/dist/js/bootstrap.min.js" async></script> <!-- JS selector for site. Chirpy v2.3 https://github.com/cotes2020/jekyll-theme-chirpy © 2020 Cotes Chung MIT Licensed --> <script src="/Study-Log/assets/js/post.min.js" async></script> <script src="/Study-Log/app.js" defer></script><body data-spy="scroll" data-target="#toc"><div id="sidebar" class="d-flex flex-column"> <!-- The Side Bar v2.0 https://github.com/cotes2020/jekyll-theme-chirpy © 2017-2019 Cotes Chung MIT License --><div id="nav-wrapper"><div id="profile-wrapper" class="d-flex flex-column"><div id="avatar" class="d-flex justify-content-center"> <a href="/Study-Log/" alt="avatar"> <img src="/Study-Log/assets/img/sample/avatar.jpg" alt="avatar" onerror="this.style.display='none'"> </a></div><div class="profile-text mt-3"><div class="site-title"> <a href="/Study-Log/">Jongsky Study Log</a></div><div class="site-subtitle font-italic">All thing are won by industry. <br> <a href="https://hits.seeyoufarm.com"><img src="https://hits.seeyoufarm.com/api/count/incr/badge.svg?url=https%3A%2F%2Fjongsky.github.io%2FStudy-Log%2F&count_bg=%23586BF3&title_bg=%23555555&icon=&icon_color=%23E7E7E7&title=Number+of+visitors&edge_flat=false"/></a></div></div></div><ul class="nav flex-column"><li class="nav-item d-flex justify-content-center "> <a href="/Study-Log/" class="nav-link d-flex justify-content-center align-items-center w-100"> <i class="fa-fw fas fa-home ml-xl-3 mr-xl-3 unloaded"></i> <span>HOME</span> </a></li><li class="nav-item d-flex justify-content-center "> <a href="/Study-Log/tabs/categories/" class="nav-link d-flex justify-content-center align-items-center w-100"> <i class="fa-fw fas fa-stream ml-xl-3 mr-xl-3 unloaded"></i> <span>CATEGORIES</span> </a></li><li class="nav-item d-flex justify-content-center "> <a href="/Study-Log/tabs/tags/" class="nav-link d-flex justify-content-center align-items-center w-100"> <i class="fa-fw fas fa-tags ml-xl-3 mr-xl-3 unloaded"></i> <span>TAGS</span> </a></li><li class="nav-item d-flex justify-content-center "> <a href="/Study-Log/tabs/archives/" class="nav-link d-flex justify-content-center align-items-center w-100"> <i class="fa-fw fas fa-archive ml-xl-3 mr-xl-3 unloaded"></i> <span>ARCHIVES</span> </a></li><li class="nav-item d-flex justify-content-center "> <a href="/Study-Log/tabs/about/" class="nav-link d-flex justify-content-center align-items-center w-100"> <i class="fa-fw fas fa-info ml-xl-3 mr-xl-3 unloaded"></i> <span>ABOUT</span> </a></li></ul></div><div class="sidebar-bottom d-flex flex-wrap justify-content-around mt-4"> <span id="mode-toggle-wrapper"> <!-- Switch the mode between dark and light. v2.1 https://github.com/cotes2020/jekyll-theme-chirpy © 2020 Cotes Chung MIT License --> <i class="mode-toggle fas fa-sun" dark-mode-invisible></i> <i class="mode-toggle fas fa-moon" light-mode-invisible></i> <script type="text/javascript"> class ModeToggle { static get MODE_KEY() { return "mode"; } static get DARK_MODE() { return "dark"; } static get LIGHT_MODE() { return "light"; } constructor() { if (this.mode != null) { if (this.mode == ModeToggle.DARK_MODE) { if (!this.isSysDarkPrefer) { this.setDark(); } } else { if (this.isSysDarkPrefer) { this.setLight(); } } } var self = this; /* always follow the system prefers */ this.sysDarkPrefers.addListener(function() { if (self.mode != null) { if (self.mode == ModeToggle.DARK_MODE) { if (!self.isSysDarkPrefer) { self.setDark(); } } else { if (self.isSysDarkPrefer) { self.setLight(); } } self.clearMode(); } }); } /* constructor() */ setDark() { $('html').attr(ModeToggle.MODE_KEY, ModeToggle.DARK_MODE); sessionStorage.setItem(ModeToggle.MODE_KEY, ModeToggle.DARK_MODE); } setLight() { $('html').attr(ModeToggle.MODE_KEY, ModeToggle.LIGHT_MODE); sessionStorage.setItem(ModeToggle.MODE_KEY, ModeToggle.LIGHT_MODE); } clearMode() { $('html').removeAttr(ModeToggle.MODE_KEY); sessionStorage.removeItem(ModeToggle.MODE_KEY); } get sysDarkPrefers() { return window.matchMedia("(prefers-color-scheme: dark)"); } get isSysDarkPrefer() { return this.sysDarkPrefers.matches; } get isDarkMode() { return this.mode == ModeToggle.DARK_MODE; } get isLightkMode() { return this.mode == ModeToggle.LIGHT_MODE; } get hasMode() { return this.mode != null; } get mode() { return sessionStorage.getItem(ModeToggle.MODE_KEY); } flipMode() { if (this.hasMode) { if (this.isSysDarkPrefer) { if (this.isLightkMode) { this.clearMode(); } else { this.setLight(); } } else { if (this.isDarkMode) { this.clearMode(); } else { this.setDark(); } } } else { if (this.isSysDarkPrefer) { this.setLight(); } else { this.setDark(); } } } /* flipMode() */ } /* ModeToggle */ let toggle = new ModeToggle(); $(".mode-toggle").click(function() { toggle.flipMode(); }); </script> </span> <span class="icon-border"></span> <a href="https://github.com/JONGSKY" target="_blank"> <i class="fab fa-github-alt"></i> </a> <a href="http://jongsky.github.io/" target="_blank"> <i class="fas fa-address-card"></i> </a> <a href=" javascript:window.open('mailto:' + ['ljhljh0125','gmail.com'].join('@'))" > <i class="fas fa-envelope"></i> </a> <a href="/Study-Log/feed.xml" > <i class="fas fa-rss"></i> </a></div></div><!-- The Top Bar v2.0 https://github.com/cotes2020/jekyll-theme-chirpy © 2017-2019 Cotes Chung MIT License --><div id="topbar-wrapper" class="row justify-content-center topbar-down"><div id="topbar" class="col-11 d-flex h-100 align-items-center justify-content-between"> <span id="breadcrumb"> <span> <a href="/Study-Log/"> Posts </a> </span> <span>언어모델, BERT 알아보기</span> </span> <i id="sidebar-trigger" class="fas fa-bars fa-fw"></i><div id="topbar-title"> Post</div><i id="search-trigger" class="fas fa-search fa-fw"></i> <span id="search-wrapper" class="align-items-center"> <i class="fas fa-search fa-fw"></i> <input class="form-control" id="search-input" type="search" placeholder="Search..."> <i class="fa fa-times-circle fa-fw" id="search-cleaner"></i> </span> <span id="search-cancel" >Cancel</span></div></div><div id="main-wrapper"><div id="main"> <!-- Refactor the HTML structure. --> <!-- Suroundding the markdown table with '<div class="table-wrapper">. and '</div>' --> <!-- Fixed kramdown code highlight rendering: https://github.com/penibelst/jekyll-compress-html/issues/101 https://github.com/penibelst/jekyll-compress-html/issues/71#issuecomment-188144901 --><div class="row"><div id="post-wrapper" class="col-12 col-lg-11 col-xl-8"><div class="post pl-1 pr-1 pl-sm-2 pr-sm-2 pl-md-4 pr-md-4"><h1 data-toc-skip>언어모델, BERT 알아보기</h1><div class="post-meta text-muted d-flex flex-column"><div> Posted <!-- Date format snippet v2.4.1 https://github.com/cotes2020/jekyll-theme-chirpy © 2020 Cotes Chung MIT License --> <span class="timeago " data-toggle="tooltip" data-placement="bottom" title="Sat, Sep 26, 2020, 2:25 AM +0900" > Sep 26, 2020 <i class="unloaded">2020-09-26T02:25:00+09:00</i> </span> by <span class="author"> JONGSKY </span></div></div><div class="post-content"><p>한국어 기사 요약 프로젝트를 시작하며 프로젝트에 도입해야할 여러 논문들과 연구들을 찾았습니다. 그중에서도 언어모델로 유명한 <code class="language-plaintext highlighter-rouge">BERT</code> 모델에 대해 정리하면 좋을 것 같다고 생각하여 작성하게 되었습니다.</p><p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-src="https://user-images.githubusercontent.com/40276516/94236173-bd2faa80-ff47-11ea-9262-184f550b6cbb.png" alt="image" /></p><h2 id="언어모델-bert-란">언어모델 BERT 란</h2><p>구글에서 개발한 인공지능(AI) 언어모델 <code class="language-plaintext highlighter-rouge">BERT</code>(이하 버트, Bidirectional Encoder Representations from Transformers)는 <strong>NLP(자연어처리) 사전 훈련 기술</strong>이며, 특정 분야에 국한된 기술이 아닌 모든 자연어 처리 분야에서 좋은 성능을 내는 <strong>범용 Language Model</strong> 입니다. 11개 이상의 자연어처리 과제에서 <code class="language-plaintext highlighter-rouge">BERT</code>가 최첨단 성능을 발휘한다고 하지만 그 이유는 잘 알려져 있지 않다고 합니다. 하지만 <code class="language-plaintext highlighter-rouge">BERT</code>는 지금까지 자연어처리에 활용하였던 앙상블 모델보다 더 좋은 성능을 내고 있어 많은 관심을 받고 있는 언어모델입니다.</p><p><code class="language-plaintext highlighter-rouge">BERT</code>등장 이전에는 데이터의 전처리 임베딩을 Word2Vec, GloVe, Fasttext 방식을 많이 사용했지만, 등장 이후 고성능을 내는 대부분의 모델에서는 <code class="language-plaintext highlighter-rouge">BERT</code>를 많이 사용하고 있다고 합니다. 임베딩 과정에서 <code class="language-plaintext highlighter-rouge">BERT</code>를 사용하는 것이고, <code class="language-plaintext highlighter-rouge">BERT</code>는 특정 모델(분류, 인식 등)를 시작 하기 전 <strong>사전 훈련 Embedding을 통해 특정 모델의 성능을 더 좋게 할 수 있는 언어모델입니다.</strong></p><h2 id="bert의-내부-동작">BERT의 내부 동작</h2><h3 id="1-input">1. Input</h3><p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-src="https://user-images.githubusercontent.com/40276516/94236526-58c11b00-ff48-11ea-8b85-822ebffd3d11.png" alt="image" /></p><p><code class="language-plaintext highlighter-rouge">BERT</code>는 위 그림과 같이 <strong>3가지의 입력 임베딩(Token, Segment, Position 임베딩)의 합으로 구성된다.</strong></p><h4 id="1-1-token-embeddings">1-1. Token Embeddings</h4><p><code class="language-plaintext highlighter-rouge">BERT</code>는 기존에 사용되던 워드 임베딩 방식의 임베딩을 사용하지 않았습니다. Word Piece 임베딩 방식을 사용핬는데 이 방식은 자주 등장하면서 가장 긴 길이의 sub-word를 하나의 단위로 만듭니다. 즉, 자주 등장하는 sub-word는 그 자체가 단위가 되고, 자주 등장하지 않는 단어(rare word)는 sub-word로 쪼개지게 됩니다. 기존 워드 임베딩 방법은 Out-of-vocabulary(OOV) 문제가 있었습니다. 희기 단어, 이름, 숫자 나 단어장에 없는 단어에 대한 학습, 번역에 어려움이 있었습니다. 그러나 Word Piece 임베딩은 모든 언어에 적용 가능하며 sub-word 단위로 단어를 분절하므로 OOV 처리에 효과적이고 정확도도 상승하는 효과가 있습니다.</p><h4 id="1-2-segment-embeddings">1-2. Segment Embeddings</h4><p><code class="language-plaintext highlighter-rouge">BERT</code>는 두 개의 문장을 문장 구분자 ([SEP])와 함께 합쳐 넣습니다. 입력 길이의 제한으로 두 문장은 합쳐서 512 subword 이하로 제한합니다. 입력의 길이가 길어질수록 학습시간은 제곱으로 증가하기 때문에 적절한 입력 길이를 설정해야 합니다. 한국어는 보통 평균 20 subword로 구성되고 99%가 60 subword를 넘지 않기 때문에 입력 길이를 두 문장이 합쳐 128로 해도 충분합니다. 하지만 간혹 긴 문장이 있으므로 우선 입력 길이 128로 제한하고 학습한 후, 128보다 긴 입력들을 모아 마지막에 따로 추가 학습하는 방식을 사용합니다.</p><h4 id="1-3-position-embedding">1-3. Position Embedding</h4><p><code class="language-plaintext highlighter-rouge">BERT</code>는 저자의 이전 논문인 Transformer 모델을 사용하였습니다. Transformer는 주로 사용하는 CNN, RNN 모델을 사용하지 않고 Self-Attention 모델을 사용합니다. Self-Attention은 입력의 위치에 대해 고려하지 못하므로 입력 토큰의 위취 정보를 줘야합니다. 그래서 Transformer에서는 Sinusoid 함수를 이용한 Positional encoding을 사용하였고, <code class="language-plaintext highlighter-rouge">BERT</code>에서는 이를 변형하여 Position encoding을 사용합니다. Position encoding은 단순하게 Token 순서대로 0,1,2,3 … 과 같이 순서대로 인코딩합니다.</p><p><code class="language-plaintext highlighter-rouge">BERT</code>는 위 세가지 임베딩을 합치고 이에 Layer정규화와 Dropout을 적용하여 입력으로 사용합니다.</p><h3 id="2-언어-모델링-구조-pre-training-bert">2. 언어 모델링 구조 (Pre-training BERT</h3><p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-src="https://user-images.githubusercontent.com/40276516/94240535-611c5480-ff4e-11ea-8106-653ac7a0511f.png" alt="image" /></p><p>데이터 임베딩 후 훈련시킬 데이터를 인코딩 하였으면, Pre-training(사전훈련)을 시킬 단계입니다. 기존의 방법들은 보통 문장을 왼쪽에서 오른쪽으로 학습하여 다음 단어를 예측하는 방식이거나, 예측할 단어의 좌우 문맥을 고려하여 예측하는 방식을 사용합니다. 그러나 <code class="language-plaintext highlighter-rouge">BERT</code>는 언어의 특성이 잘 학습되도록 2가지 방식, <strong>MLM(Masked Language Model)과 NSP(Next Sentence Prediction)을 사용합니다.</strong></p><p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-src="https://user-images.githubusercontent.com/40276516/94241593-ce7cb500-ff4f-11ea-9556-d7f2a0b8e6a5.png" alt="image" /></p><p>논문에서는 기존(좌에서 우로 학습하는 모델)방식과 비교하여 MLM방식이 더 좋은 성능을 보여주고 있다고 말합니다.</p><h4 id="2-1-언어-모델링-데이터">2-1. 언어 모델링 데이터</h4><p><code class="language-plaintext highlighter-rouge">BERT</code>는 총 33억개 단어(BookCorpus 8억개 단어 + Wikipedia 25억개 단어)의 거대한 말뭉치를 이용하여 학습합니다. 건대한 말뭉치를 MLM, NSP 모델 적용을 위해 <strong>스스로 라벨을 만들고 수행하여 준지도학습이라고 합니다.</strong></p><h4 id="2-2-모델-구조">2-2. 모델 구조</h4><p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-src="https://user-images.githubusercontent.com/40276516/94242512-18b26600-ff51-11ea-8b84-92d9726ef4a1.png" alt="image" /></p><p><code class="language-plaintext highlighter-rouge">BERT</code> 모델은 Transformer를 기반으로 합니다. 위 그림은 Transformer 모델 구조로 인코더-디코더 모델이며 번역 도메인에서 최고 성능을 기록하였습니다. 기존 인코더-디코더 모델들과 다르게 Transformer는 CNN, RNN을 이용하지 않고 Self-attetion이라는 개념을 도입하였습니다. <code class="language-plaintext highlighter-rouge">BERT</code>는 Transformer의 인코더-디코더 중 인코더만 사용하는 모델입니다.</p><p><code class="language-plaintext highlighter-rouge">BERT</code>는 2가지 버전이 있습니다.</p><ul><li>BERT-base (L=12, H=768, A=12)</li><li>BERT-large (L=24, H=1024, A=16)</li></ul><p><strong>L은 Transformer 블록의 숫자이고 H는 hidden size, A는 Transformer의 Attetion block 숫자입니다.</strong> 즉 L,H,A가 크다는 것은 블록을 많이 쌓았고, 표현하는 은닉층이 크며 Attetion 개수를 많이 사용하였다는 뜻입니다. BERT-base는 1.1억개의 학습 파라미터, BERT-large는 3.4억개의 학습 파라미터가 있습니다. BERT는 학습파라미터가 매우 많기때문에 학습시간이 무척 오래걸립니다.</p><h4 id="2-3-mlm-masked-language-model">2-3. MLM (Masked Language Model)</h4><dl><dt><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-src="https://user-images.githubusercontent.com/40276516/94241805-18659b00-ff50-11ea-97a9-ce9880d1576b.png" alt="image" /><dd><p>입력 문장에서 임의로 토큰을 버리고(Mask), 그 토큰을 맞추는 방식으로 학습을 진행합니다.</p></dl><h4 id="2-4-nsp-next-sentence-prediction">2-4. NSP (Next Sentence Prediction)</h4><dl><dt><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-src="https://user-images.githubusercontent.com/40276516/94241907-421ec200-ff50-11ea-9787-6e96af4fd287.png" alt="image" /><dd><p>두 문장이 주어졌을 때, 두 문장의 순서를 예측하는 방식입니다. 두 문장 간 관련이 고려되야 하는 NLI와 QA의 파인 튜닝을 위해 두 문장의 연관을 맞추는 학습을 진행합니다.</p></dl><h3 id="3-학습된-언어모델-전이학습-transfer-learning">3. 학습된 언어모델 전이학습 (Transfer Learning)</h3><p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-src="https://user-images.githubusercontent.com/40276516/94243666-ab073980-ff52-11ea-94af-bc15226107a1.png" alt="image" /></p><p>실질적으로 성능이 관칠되는 것은 전이학습이지만, 언어 모델이 제대로 학습되어야 전이학습 시 좋은 성능이 나옵니다. 기존 알고리즘들은 자연어의 다양한 Task에 가각의 알고리즘을 독립적으로 만들어야 했습니다. 하지만 <code class="language-plaintext highlighter-rouge">BERT</code> 개발 이후 많은 자연어처리 연구자들은 언어 모델을 만드는데 더 공을 들이게 되었습니다. 그리고 전이학습 Task의 성능도 훨씬 더 좋아졌습니다. <strong>전이학습은 라벨이 주어지므로 지도학습(Supervised Learning)입니다.</strong></p><p>전이학습은 <code class="language-plaintext highlighter-rouge">BERT</code>의 언어 모델의 출력에 추가적인 모델을 쌓아 만듭니다. 일반적으로 복잡한 CNN, LSTM, Attetion을 쌓지 않고 간단한 DNN만 쌓아도 성능이 잘 나오며 별 차이가 없다고 알려져 있습니다.</p><h2 id="bert의-한계점">BERT의 한계점</h2><p><code class="language-plaintext highlighter-rouge">BERT</code>는 일반 NLP모델에서 잘 작동하지만, Bio, Science, Finace 등 특정 분야의 언어모델에 사용하려면 잘 적용되지 않는다고 합니다. 사용단어들이 다르고 언어의 특성이 다르기 때문이라고 합니다. 따라서 특정 분야에 대해 <code class="language-plaintext highlighter-rouge">BERT</code>를 적용하려면 특정 분야의 특성을 수집할 수 있는 언어데이터들을 수집하고, 언어모델 학습을 추가적으로 진행해주어야 합니다.</p><h2 id="결론">결론</h2><p><code class="language-plaintext highlighter-rouge">BERT</code>는 18년 10월 처음 발표된 이래로 조금씩 변형된 수많은 모델들이 쏟아져 나오고 있습니다. 구글, Facebbok, MS 등과 같이 엄청난 리소스와 인력으로 일반 기억에서는 시도도 못할 정도입니다. 점점 자연어 처리 분야가 리소스가 없으면 접근도 할 수 없이 진입장벽이 높아지는 것 같다고 많이 말합니다.</p><p><code class="language-plaintext highlighter-rouge">BERT</code>의 성능을 능가하기 위해 더 큰 모델과 학습 데이터를 이용한 XLNet, RoBERTa 연구가 진행되고 학습시간을 줄이기 위해 Floating point 16을 사용하는 방법이나, 모델을 경량화 하는 ALBERT, Knowledge distillation 연구도 활발하게 진행되고 있습니다.</p><p>빠르게 발전하는 자연어 처리 모델을 공부하는 것도 중요하지만 논문을 정확히 이해하고 습득할 수 있어야 한다고 생각합니다. 또한 실제 운용을 위한 모델 경량화, 자신의 데이터에 맞는 적절한 전처리 작업이 훨씬 중요하다고 말합니다.</p><h3 id="출처">출처</h3><ul><li><a href="https://arxiv.org/pdf/1810.04805.pdf">BERT: Pre-training of Deep Bidirectional Transformers for Language Understanding</a></li><li><a href="http://docs.likejazz.com/bert/">BERT 돌아보기</a></li><li><a href="http://jalammar.github.io/illustrated-bert/">The Illustrated BERT, ELMo, and co. (How NLP Cracked Transfer Learning)</a></li><li><a href="https://ebbnflow.tistory.com/151">BERT에 대해 쉽게 알아보기1</a></li><li><a href="http://www.aitimes.kr/news/articleView.html?idxno=13117">인공지능(AI)언어모델 BERT(버트)는 무엇인가</a></li><li><a href="https://keep-steady.tistory.com/19">BERT를 파해쳐 보자!!</a></li></ul></div><div class="post-tail-wrapper text-muted"><div class="post-meta mb-3"> <i class="far fa-folder-open fa-fw mr-1"></i> <a href='/Study-Log/categories/nlp/'>NLP</a></div><div class="post-tags"> <i class="fa fa-tags fa-fw mr-1"></i> <a href="/Study-Log/tags/bert/" class="post-tag no-text-decoration" >bert</a> <a href="/Study-Log/tags/nlp/" class="post-tag no-text-decoration" >nlp</a></div><div class="post-tail-bottom d-flex justify-content-between align-items-center mt-3 pt-5 pb-2"><div class="license-wrapper"> This post is licensed under <a href="https://creativecommons.org/licenses/by/4.0/">CC BY 4.0</a> by the author.</div><!-- Post sharing snippet v2.1 https://github.com/cotes2020/jekyll-theme-chirpy © 2019 Cotes Chung Published under the MIT License --><div class="share-wrapper"> <span class="share-label text-muted mr-1">Share</span> <span class="share-icons"> <a href="https://twitter.com/intent/tweet?text=언어모델, BERT 알아보기 - Jongsky Study Log&url=https://JONGSKY.github.io/Study-Log/posts/%EC%96%B8%EC%96%B4%EB%AA%A8%EB%8D%B8,-BERT-%EC%95%8C%EC%95%84%EB%B3%B4%EA%B8%B0/" data-toggle="tooltip" data-placement="top" title="Twitter" target="_blank"> <i class="fa-fw fab fa-twitter"></i> </a> <a href="https://www.facebook.com/sharer/sharer.php?title=언어모델, BERT 알아보기 - Jongsky Study Log&u=https://JONGSKY.github.io/Study-Log/posts/%EC%96%B8%EC%96%B4%EB%AA%A8%EB%8D%B8,-BERT-%EC%95%8C%EC%95%84%EB%B3%B4%EA%B8%B0/" data-toggle="tooltip" data-placement="top" title="Facebook" target="_blank"> <i class="fa-fw fab fa-facebook-square"></i> </a> <a href="https://telegram.me/share?text=언어모델, BERT 알아보기 - Jongsky Study Log&url=https://JONGSKY.github.io/Study-Log/posts/%EC%96%B8%EC%96%B4%EB%AA%A8%EB%8D%B8,-BERT-%EC%95%8C%EC%95%84%EB%B3%B4%EA%B8%B0/" data-toggle="tooltip" data-placement="top" title="Telegram" target="_blank"> <i class="fa-fw fab fa-telegram"></i> </a> <a href="https://www.linkedin.com/sharing/share-offsite/?url=https://JONGSKY.github.io/Study-Log/posts/%EC%96%B8%EC%96%B4%EB%AA%A8%EB%8D%B8,-BERT-%EC%95%8C%EC%95%84%EB%B3%B4%EA%B8%B0/" data-toggle="tooltip" data-placement="top" title="Linkedin" target="_blank"> <i class="fa-fw fab fa-linkedin"></i> </a> <i class="fa-fw fas fa-link small" onclick="copyLink()" data-toggle="tooltip" data-placement="top" title="Copy link"></i> </span></div></div></div></div></div><!-- The Pannel on right side (Desktop views) v2.0 https://github.com/cotes2020/jekyll-theme-chirpy © 2017-2019 Cotes Chung MIT License --><div id="panel-wrapper" class="col-xl-3 pl-2 text-muted topbar-down"><div class="access"><div id="access-lastmod" class="post"><h3 data-toc-skip>Recent Update</h3><ul class="post-content pl-0 pb-1 ml-1 mt-2"><li><a href="/Study-Log/posts/%EB%8F%84%EC%BB%A4%EC%99%80-%EC%BF%A0%ED%8D%BC%EB%84%A4%ED%8B%B0%EC%8A%A4%EC%9D%98-%EC%B0%A8%EC%9D%B4/">도커와 쿠버네티스의 차이</a></li><li><a href="/Study-Log/posts/ADsP-%EC%9E%90%EA%B2%A9%EC%A6%9D-%EC%A0%95%EB%A6%AC-%EB%B0%8F-%ED%9B%84%EA%B8%B0/">ADsP 자격증 정리 및 후기</a></li><li><a href="/Study-Log/posts/Notion%EC%97%90-%EB%B0%A9%EB%AC%B8%EC%9E%90%EC%88%98-%EC%B6%94%EA%B0%80%ED%95%98%EA%B8%B0/">Notion에 방문자수 추가하기</a></li></ul></div><div id="access-tags"><h3 data-toc-skip>Trending Tags</h3><div class="d-flex flex-wrap mt-3 mb-1 mr-3"> <a class="post-tag" href="/Study-Log/tags/docker/">docker</a> <a class="post-tag" href="/Study-Log/tags/github/">github</a> <a class="post-tag" href="/Study-Log/tags/certification/">certification</a> <a class="post-tag" href="/Study-Log/tags/%EA%B2%80%EC%83%89%EC%97%94%EC%A7%84/">검색엔진</a> <a class="post-tag" href="/Study-Log/tags/tableau/">tableau</a> <a class="post-tag" href="/Study-Log/tags/python/">python</a> <a class="post-tag" href="/Study-Log/tags/project/">project</a> <a class="post-tag" href="/Study-Log/tags/notion/">notion</a> <a class="post-tag" href="/Study-Log/tags/nlp/">nlp</a> <a class="post-tag" href="/Study-Log/tags/method/">method</a></div></div></div></div></div><div class="row"><div class="col-12 col-lg-11 col-xl-8"><div id="post-extend-wrapper" class="pl-1 pr-1 pl-sm-2 pr-sm-2 pl-md-4 pr-md-4"> <!-- Recommend the other 3 posts according to the tags and categories of the current post, if the number is not enough, use the other latest posts to supplement. v2.0 https://github.com/cotes2020/jekyll-theme-chirpy © 2019 Cotes Chung Published under the MIT License --><div id="related-posts" class="mt-5 mb-2 mb-sm-4"><h3 class="pt-2 mt-1 mb-4 ml-1" data-toc-skip>Further Reading</h3><div class="card-deck mb-4"><div class="card"> <a href="/Study-Log/posts/%EB%8F%84%EC%BB%A4%EC%99%80-%EC%BF%A0%ED%8D%BC%EB%84%A4%ED%8B%B0%EC%8A%A4%EC%9D%98-%EC%B0%A8%EC%9D%B4/"><div class="card-body"> <!-- Date format snippet v2.4.1 https://github.com/cotes2020/jekyll-theme-chirpy © 2020 Cotes Chung MIT License --> <span class="timeago small" > Nov 19, 2020 <i class="unloaded">2020-11-19T03:00:00+09:00</i> </span><h3 class="pt-0 mt-1 mb-3" data-toc-skip>도커와 쿠버네티스의 차이</h3><div class="text-muted small"><p> 도커와 쿠버네티스는 어떻게 다를까? 도커 : 여러 컨터이너를 관리/예약하는 플랫폼 쿠버네티스 : 여러 컨테이너를 관리/예약하는 도구 플랫폼과 도구 무슨 차이일까? 도커와 쿠버네티스의 차이 도커 도커는 ‘컨테이너 기반의 오픈소스 가상화 플랫폼’ 이다. 기능 하나하나를 컨테이너로 만들어서 프로그램을 돌린다고 생각하면 된다. 예를 들어 웹을...</p></div></div></a></div><div class="card"> <a href="/Study-Log/posts/ADsP-%EC%9E%90%EA%B2%A9%EC%A6%9D-%EC%A0%95%EB%A6%AC-%EB%B0%8F-%ED%9B%84%EA%B8%B0/"><div class="card-body"> <!-- Date format snippet v2.4.1 https://github.com/cotes2020/jekyll-theme-chirpy © 2020 Cotes Chung MIT License --> <span class="timeago small" > Oct 2, 2020 <i class="unloaded">2020-10-02T12:00:00+09:00</i> </span><h3 class="pt-0 mt-1 mb-3" data-toc-skip>ADsP 자격증 정리 및 후기</h3><div class="text-muted small"><p> 안녕하세요. 오늘 소개해드릴 자격증은 ADsP입니다! 데이터 관련 직무를 하시는 분들은 한번쯤 들어보셨을 자격증이라고 생각합니다. 국가공인 데이터분석 준전문가(이하 ADsp)에 대한 시험주요내용, 출제문항 및 배점, 응시자격 및 합격기준 등에 대해 소개하며 제가 공부하면서 공부했던 방법들에 대해서 소개해드리도록 하겠습니다. 저도 해당 자격증에 대해 ...</p></div></div></a></div><div class="card"> <a href="/Study-Log/posts/Notion%EC%97%90-%EB%B0%A9%EB%AC%B8%EC%9E%90%EC%88%98-%EC%B6%94%EA%B0%80%ED%95%98%EA%B8%B0/"><div class="card-body"> <!-- Date format snippet v2.4.1 https://github.com/cotes2020/jekyll-theme-chirpy © 2020 Cotes Chung MIT License --> <span class="timeago small" > Oct 1, 2020 <i class="unloaded">2020-10-01T09:45:00+09:00</i> </span><h3 class="pt-0 mt-1 mb-3" data-toc-skip>Notion에 방문자수 추가하기</h3><div class="text-muted small"><p> 안녕하세요! 오늘은 Notion에 방문자수를 보여줄 수 있는 기능을 추가하는 내용을 해보려고 합니다. 미리보는 결과 화면 입니다! 이번년도에는 지금까지 했던 프로젝트를 정리도 하고 포트폴리오도 미리 만드는 작업을 하고 있었습니다! 내년 3월이면 임관해서 군대를 가기 때문이죠…ㅠㅠ 최근에 포트폴리오를 만든다고 github에서 제공해주는 githu...</p></div></div></a></div></div></div><!-- Navigation buttons at the bottom of the post. v2.1 https://github.com/cotes2020/jekyll-theme-chirpy © 2020 Cotes Chung MIT License --><div class="post-navigation d-flex justify-content-between"> <a href="/Study-Log/posts/Docker,-%EB%8F%84%EC%BB%A4-%EC%97%94%EC%A7%84-2/" class="btn btn-outline-primary"><p>Docker, 도커 엔진 - 2</p></a> <a href="/Study-Log/posts/Notion%EC%97%90-%EB%B0%A9%EB%AC%B8%EC%9E%90%EC%88%98-%EC%B6%94%EA%B0%80%ED%95%98%EA%B8%B0/" class="btn btn-outline-primary"><p>Notion에 방문자수 추가하기</p></a></div><!-- The Disqus lazy loading. Powered by: https://osvaldas.info/lazy-loading-disqus-comments v2.0 https://github.com/cotes2020/jekyll-theme-chirpy © 2019 Cotes Chung MIT License --><div id="disqus" class="pt-2 pb-2"><p class="font-italic text-center text-muted small"> Comments powered by <a href="https://disqus.com/">Disqus</a>.</p></div><script src="/Study-Log/assets/js/lib/jquery.disqusloader.min.js"></script> <script> var options = { scriptUrl: '//https-jongsky-github-io-study-log.disqus.com/embed.js', disqusConfig: function() { this.page.url = 'https://JONGSKY.github.io/Study-Log/posts/%EC%96%B8%EC%96%B4%EB%AA%A8%EB%8D%B8,-BERT-%EC%95%8C%EC%95%84%EB%B3%B4%EA%B8%B0/'; this.page.identifier = '/posts/%EC%96%B8%EC%96%B4%EB%AA%A8%EB%8D%B8,-BERT-%EC%95%8C%EC%95%84%EB%B3%B4%EA%B8%B0/'; } }; $.disqusLoader('#disqus', options); </script></div></div></div><script type="text/javascript" src="https://cdn.jsdelivr.net/npm/lozad/dist/lozad.min.js"></script> <script type="text/javascript"> const imgs = document.querySelectorAll('#post-wrapper img'); const observer = lozad(imgs); observer.observe(); </script> <!-- The Footer v2.0 https://github.com/cotes2020/jekyll-theme-chirpy © 2017-2019 Cotes Chung MIT License --><footer class="d-flex w-100 justify-content-center"><div class="d-flex justify-content-between align-items-center"><div class="footer-left"><p class="mb-0"> © 2021 <a href="https://www.linkedin.com/in/jong-sky/">Jongho Lee</a>. <span data-toggle="tooltip" data-placement="top" title="Except where otherwise noted, the blog posts on this site are licensed under the Creative Commons Attribution 4.0 International (CC BY 4.0) License by the author.">Some rights reserved.</span></p></div><div class="footer-right"><p class="mb-0"> Powered by <a href="https://jekyllrb.com" target="_blank">Jekyll</a> with <a href="https://github.com/cotes2020/jekyll-theme-chirpy/">Chirpy</a> theme.</p></div></div></footer></div><!-- The Search results v2.0 https://github.com/cotes2020/jekyll-theme-chirpy © 2017-2019 Cotes Chung MIT License --><div id="search-result-wrapper" class="d-flex justify-content-center unloaded"><div class="col-12 col-xl-11 post-content"><div id="search-hints"><h4 class="text-muted mb-4">Trending Tags</h4><a class="post-tag" href="/Study-Log/tags/docker/">docker</a> <a class="post-tag" href="/Study-Log/tags/github/">github</a> <a class="post-tag" href="/Study-Log/tags/certification/">certification</a> <a class="post-tag" href="/Study-Log/tags/%EA%B2%80%EC%83%89%EC%97%94%EC%A7%84/">검색엔진</a> <a class="post-tag" href="/Study-Log/tags/tableau/">tableau</a> <a class="post-tag" href="/Study-Log/tags/python/">python</a> <a class="post-tag" href="/Study-Log/tags/project/">project</a> <a class="post-tag" href="/Study-Log/tags/notion/">notion</a> <a class="post-tag" href="/Study-Log/tags/nlp/">nlp</a> <a class="post-tag" href="/Study-Log/tags/method/">method</a></div><div id="search-results" class="d-flex flex-wrap justify-content-center text-muted mt-3"></div></div></div></div><div id="mask"></div><a id="back-to-top" href="#" class="btn btn-lg btn-box-shadow" role="button"> <i class="fas fa-angle-up"></i> </a> <!-- The GA snippet v2.0 https://github.com/cotes2020/jekyll-theme-chirpy © 2017-2019 Cotes Chung MIT License --> <script> (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){ (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o), m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m) })(window,document,'script','https://www.google-analytics.com/analytics.js','ga'); ga('create', 'UA-176822305-1', 'auto'); ga('send', 'pageview'); </script> <!-- Jekyll Simple Search loader v2.0 https://github.com/cotes2020/jekyll-theme-chirpy © 2017-2019 Cotes Chung MIT License --> <script src="https://cdn.jsdelivr.net/npm/simple-jekyll-search@1.7.3/dest/simple-jekyll-search.min.js"></script> <script> SimpleJekyllSearch({ searchInput: document.getElementById('search-input'), resultsContainer: document.getElementById('search-results'), json: '/Study-Log/assets/js/data/search.json', searchResultTemplate: '<div class="pl-1 pr-1 pl-sm-2 pr-sm-2 pl-lg-4 pr-lg-4 pl-xl-0 pr-xl-0"> <a href="https://JONGSKY.github.io{url}">{title}</a><div class="post-meta d-flex flex-column flex-sm-row text-muted mt-1 mb-1"><div class="mr-sm-4"><i class="far fa-folder fa-fw"></i>{categories}</div><div><i class="fa fa-tag fa-fw"></i>{tags}</div></div><p>{snippet}</p></div>', noResultsText: '<p class="mt-5">Oops! No result founds.</p>' }); </script>
